<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  File: README_DEVELOPER
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "";
  relpath = '';
</script>


  <script type="text/javascript" charset="utf-8" src="js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="file_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="_index.html">Index</a> &raquo; 
    <span class="title">File: README_DEVELOPER</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><div id='filecontents'><h1 id="puppet-specific-facts">Puppet Specific Facts</h1>

<p>Facter is meant to stand alone and apart from Puppet.  However, Facter often
runs inside Puppet and all custom facts included in the stdlib module will
almost always be evaluated in the context of Puppet and Facter working
together.</p>

<p>Still, we don’t want to write custom facts that blow up in the users face if
Puppet is not loaded in memory.  This is often the case if the user runs
<code>facter</code> without also supplying the <code>--puppet</code> flag.</p>

<p>Ah! But Jeff, the custom fact won’t be in the <code>$LOAD_PATH</code> unless the user
supplies <code>--facter</code>! You might say…</p>

<p>Not (always) true I say!  If the user happens to have a CWD of
<code>&lt;modulepath&gt;/stdlib/lib</code> then the facts will automatically be evaluated and
blow up.</p>

<p>In any event, it’s pretty easy to write a fact that has no value if Puppet is
not loaded.  Simply do it like this:</p>

<pre class="code ruby"><code class="ruby"><span class='const'><span class='object_link'><a href="Facter.html" title="Facter (module)">Facter</a></span></span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span><span class='lparen'>(</span><span class='symbol'>:node_vardir</span><span class='rparen'>)</span> <span class='kw'>do</span>
  <span class='id identifier rubyid_setcode'>setcode</span> <span class='kw'>do</span>
    <span class='comment'># This will be nil if Puppet is not available.
</span>    <span class='const'><span class='object_link'><a href="Facter.html" title="Facter (module)">Facter</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Facter/Util.html" title="Facter::Util (module)">Util</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="Facter/Util/PuppetSettings.html" title="Facter::Util::PuppetSettings (module)">PuppetSettings</a></span></span><span class='period'>.</span><span class='id identifier rubyid_with_puppet'><span class='object_link'><a href="Facter/Util/PuppetSettings.html#with_puppet-class_method" title="Facter::Util::PuppetSettings.with_puppet (method)">with_puppet</a></span></span> <span class='kw'>do</span>
      <span class='const'>Puppet</span><span class='lbracket'>[</span><span class='symbol'>:vardir</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>
  <span class='kw'>end</span>
<span class='kw'>end</span>
</code></pre>

<p>The <code>Facter::Util::PuppetSettings.with_puppet</code> method accepts a block and
yields to it only if the Puppet library is loaded.  If the Puppet library is
not loaded, then the method silently returns <code>nil</code> which Facter interprets as
an undefined fact value.  The net effect is that the fact won’t be set.</p>
</div></div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>