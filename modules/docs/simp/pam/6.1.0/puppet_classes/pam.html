<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Class: pam
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_classes::pam";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (p)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Classes</span></span>
     &raquo; 
    <span class="title">pam</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Class: pam</h1>
<div class="box_info">
  
  
  <dl>
    <dt>Defined in:</dt>
    <dd>
      /tmp/tmp_git_repo20171214-12245-17utfmh/manifests/init.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    <p>This class ensures that reasonable PAM security options are applied.</p>

<p>It also takes into account the global SIMP settings for LDAP and SSSD.</p>

<p>Many options are exposed here that may affect a large number of lower-level
PAM module settings. This is done to provide continuity across the PAM stack
where possible.</p>

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>password_check_backend</span>
      
      
        <span class='type'>(<tt>Pam::PasswordBackends</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The password checking library to use</p>

<ul>
  <li>The default is based on the OS being targeted and is pulled from module
data</li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_difok</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>4</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The number of character changes between the old password and the new
password that are enough to accept the new password</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_maxrepeat</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>2</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Reject passwords which contain more than this many of the same consecutive
characters</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_maxsequence</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>4</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Reject passwords which contain monotonic character sequences
longer than this</p>

<ul>
  <li>
    <p>The default is 0 which means that this check is disabled. Examples of
such sequence are <code>12345</code> or <code>fedcb</code></p>
  </li>
  <li>
    <p>Most such passwords will not pass the simplicity check unless the
sequence is only a minor part of the password</p>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_maxclassrepeat</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>0</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Reject passwords which contain more than this many consecutive characters
of the <strong>same class</strong></p>

<ul>
  <li>Character classes include:
    <ul>
      <li>Upper Case</li>
      <li>Lower Case</li>
      <li>Digit</li>
      <li>Special Character</li>
    </ul>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_gecoscheck</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Check whether the words from the GECOS field (usualy full name of the user)
longer than 3 characters in straight or reversed form are contained in the
new password</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_enforce_for_root</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Enforce all password check settings for the <code>root</code> user</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_dcredit</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>-</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The required credit for having digits in the new password</p>

<ul>
  <li>
    <p>For Positive Integers: If you have less than or N digits, each digit will
count +1 towards meeting the current minlen value</p>
  </li>
  <li>
    <p>For Negative Integers: The minimum number of digits that must be met for
a new password</p>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_ucredit</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>-</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The required credit for having upper case letters in the new password</p>

<ul>
  <li>
    <p>For Positive Integers: If you have less than or N characters , each
character will count +1 towards meeting the current minlen value</p>
  </li>
  <li>
    <p>For Negative Integers: The minimum number of characters that must be met
for a new password</p>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_lcredit</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>-</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The required credit for having lower case letters in the new password</p>

<ul>
  <li>
    <p>For Positive Integers: If you have less than or N characters , each
character will count +1 towards meeting the current minlen value</p>
  </li>
  <li>
    <p>For Negative Integers: The minimum number of characters that must be met
for a new password</p>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_ocredit</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>-</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The required credit for having special characters in the new password</p>

<ul>
  <li>
    <p>For Positive Integers: If you have less than or N characters , each
character will count +1 towards meeting the current minlen value</p>
  </li>
  <li>
    <p>For Negative Integers: The minimum number of characters that must be met
for a new password</p>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_minclass</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>3</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The minimum number of required classes for the new password</p>

<ul>
  <li>
    <p>The four classes are digits, upper and lower letters and other characters</p>
  </li>
  <li>
    <p>The difference to the credit check is that a specific class if of
characters is not required.  Instead N out of four of the classes are
required.</p>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_minlen</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>15</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The minimum acceptable size for the new password (plus one if credits are
not disabled)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_reject_username</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Don’t let the username be used in password</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_retry</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>3</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Prompt user at most N times before returning with error</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_badwords</span>
      
      
        <span class='type'>(<tt>Optional[Array[String]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Array of words that must not be contained in the password.
These are additional words to the cracklib dictionary check.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>cracklib_dictpath</span>
      
      
        <span class='type'>(<tt>Optional[StdLib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Path to the cracklib dictionaries. Default is to use the cracklib default.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rm_pwquality_conf_d</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Remove the /etc/security/pwquality.conf.d directory and all contents.</p>

<ul>
  <li>This ensures authoritative management of <code>pwquality</code> without the
ability of users to override our settings directly on the system.</li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>deny</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>5</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The number of failed attempts before PAM denies a user from logging in</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>display_account_lock</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Display to the remote user that their account has been locked</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>fail_interval</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>900</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Sets the time until the check fails</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>homedir_umask</span>
      
      
        <span class='type'>(<tt>Simplib::Umask</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;0077&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Sets the file mode creation mask of the user home directories</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>remember</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>24</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The last N passwords for each user are saved in <code>/etc/security/opasswd</code>
in order to force password change history and keep the user from
alternating between the same password too frequently</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>remember_retry</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>1</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Allow this many retries</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>remember_for_root</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Remember the last <code>$remember</code> passwords for the root user</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>root_unlock_time</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>60</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Allow access after N seconds to root account after failed attempt</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>rounds</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>10000</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Set the optional number of rounds of the <code>SHA256</code>, <code>SHA512</code> and
<code>Blowfish</code> password hashing algorithms to N</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>uid</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>500</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Allow user logins for userse with UID higher than N</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>unlock_time</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>900</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Allow acesss after N seconds to user account after failed attempt</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>preserve_ac</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Keep the original <code>-ac</code> files around for reference</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>warn_if_unknown</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If you make it to the <code>other</code> PAM configuration file, then provide a
warning that the login method was uncaught by other PAM stacks</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>deny_if_unknown</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If true, deny any access to an application that falls all the way through
the PAM stack to <code>other</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>use_netgroups</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Default: false
Set PAM up to use NIS netgroups.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>use_openshift</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Set PAM to work with OpenShift</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>sssd</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>simplib::lookup(&#39;simp_options::sssd&#39;, { &#39;default_value&#39; =&gt; false})</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Set PAM to work with SSSD</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>tty_audit_users</span>
      
      
        <span class='type'>(<tt>Array[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[ &#39;root&#39; ]</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The users for which TTY auditing is enabled</p>

<ul>
  <li>Set to an empty Array to not audit TTY actions for any user</li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>su_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that should be used to fill <code>/etc/pam.d/su</code> instead of the
templated content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>other_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that should be used to fill <code>/etc/pam.d/other</code> instead of the
templated content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>auth_sections</span>
      
      
        <span class='type'>(<tt>Array[Enum[
    'fingerprint',
    'system',
    'password',
    'smartcard'
  ]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>[ &#39;fingerprint&#39;, &#39;system&#39;, &#39;password&#39;, &#39;smartcard&#39; ]</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The PAM <code>*-auth</code> files to manage</p>

<ul>
  <li>Set to an empty Array to not manage any sections</li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>fingerprint_auth_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that should be used to fill <code>/etc/pam.d/fingerprint_auth</code>
instead of the templated content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>system_auth_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that should be used to fill <code>/etc/pam.d/system_auth</code> instead
of the templated content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>password_auth_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that should be used to fill <code>/etc/pam.d/password_auth</code>
instead of the templated content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>smartcard_auth_content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that should be used to fill <code>/etc/pam.d/smartcard_auth</code>
instead of the templated content</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>enable</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If you have included this module but want it to stop managing your
configuration files set this to <code>false</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>enable_warning</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Will issue a warning if this module is included but global catalyst
<code>simp_options::pam</code> is set to <code>false</code></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>enable_separator</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Enable a custom list separator.
<strong>WARNING</strong> this setting may break pam_access on some platforms.
  Use with caution</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>separator</span>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;,&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Separator to use for user and origin lists</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>disable_authconfig</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Disable authconfig from being used, as it breaks this module’s reconfiguration
of PAM.</p>
</div>
      
    </li>
  
</ul>


</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File '/tmp/tmp_git_repo20171214-12245-17utfmh/manifests/init.pp', line 230</span>

class pam (
  # Data in modules
  Pam::PasswordBackends          $password_check_backend,
  Integer[0]                     $cracklib_difok            = 4,
  Integer[0]                     $cracklib_maxrepeat        = 2,
  Integer[0]                     $cracklib_maxsequence      = 4,
  Integer[0]                     $cracklib_maxclassrepeat   = 0,
  Boolean                        $cracklib_gecoscheck       = true,
  Boolean                        $cracklib_enforce_for_root = true,
  Boolean                        $cracklib_reject_username  = true,
  Integer                        $cracklib_dcredit          = -1,
  Integer                        $cracklib_ucredit          = -1,
  Integer                        $cracklib_lcredit          = -1,
  Integer                        $cracklib_ocredit          = -1,
  Integer[0]                     $cracklib_minclass         = 3,
  Integer[0]                     $cracklib_minlen           = 15,
  Integer[0]                     $cracklib_retry            = 3,
  Optional[Array[String]]        $cracklib_badwords         = undef,
  Optional[StdLib::Absolutepath] $cracklib_dictpath         = undef,
  Boolean                        $rm_pwquality_conf_d       = true,
  Integer[0]                     $deny                      = 5,
  Boolean                        $display_account_lock      = false,
  Simplib::Umask                 $homedir_umask             = &#39;0077&#39;,
  Integer[0]                     $remember                  = 24,
  Integer[0]                     $remember_retry            = 1,
  Boolean                        $remember_for_root         = true,
  Integer[0]                     $root_unlock_time          = 60,
  Integer[0]                     $rounds                    = 10000,
  Integer[0]                     $uid                       = 500,
  Integer[0]                     $unlock_time               = 900,
  Integer[0]                     $fail_interval             = 900,
  Boolean                        $preserve_ac               = false,
  Boolean                        $warn_if_unknown           = true,
  Boolean                        $deny_if_unknown           = true,
  Boolean                        $use_netgroups             = false,
  Boolean                        $use_openshift             = false,
  Boolean                        $sssd                      = simplib::lookup(&#39;simp_options::sssd&#39;, { &#39;default_value&#39; =&gt; false}),
  Boolean                        $enable_separator          = true,
  String                         $separator                 = &#39;,&#39;,
  Array[String]                  $tty_audit_users           = [ &#39;root&#39; ],
  Array[Enum[
    &#39;fingerprint&#39;,
    &#39;system&#39;,
    &#39;password&#39;,
    &#39;smartcard&#39;
  ]]                             $auth_sections             = [ &#39;fingerprint&#39;, &#39;system&#39;, &#39;password&#39;, &#39;smartcard&#39; ],
  Optional[String]               $su_content                = undef,
  Optional[String]               $other_content             = undef,
  Optional[String]               $fingerprint_auth_content  = undef,
  Optional[String]               $system_auth_content       = undef,
  Optional[String]               $password_auth_content     = undef,
  Optional[String]               $smartcard_auth_content    = undef,
  Boolean                        $enable                    = true,
  Boolean                        $enable_warning            = true,
  Boolean                        $disable_authconfig        = true
) {
  if simplib::lookup(&#39;simp_options::pam&#39;, { &#39;default_value&#39; =&gt; true } ) {
    if $enable {
      include &#39;pam::install&#39;

      file { &#39;/etc/pam.d&#39;:
        ensure  =&gt; &#39;directory&#39;,
        owner   =&gt; &#39;root&#39;,
        group   =&gt; &#39;root&#39;,
        mode    =&gt; &#39;0644&#39;,
        recurse =&gt; true
      }

      if $password_check_backend == &#39;pwquality&#39; {
        file { &#39;/etc/security/pwquality.conf&#39;:
          ensure  =&gt; &#39;file&#39;,
          owner   =&gt; &#39;root&#39;,
          group   =&gt; &#39;root&#39;,
          mode    =&gt; &#39;0644&#39;,
          content =&gt; template(&quot;${module_name}/etc/security/pwquality.conf.erb&quot;)
        }

        if $rm_pwquality_conf_d {
          # Ensure that we can&#39;t be overridden
          file { &#39;/etc/security/pwquality.conf.d&#39;:
            ensure =&gt; &#39;absent&#39;,
            force  =&gt; true
          }
        }
      }

      if $other_content {
        $_other_content = $other_content
      }
      else {
        $_other_content = template(&#39;pam/etc/pam.d/other.erb&#39;)
      }

      file {
        default:
          ensure =&gt; &#39;file&#39;,
          owner  =&gt; &#39;root&#39;,
          group  =&gt; &#39;root&#39;,
          mode   =&gt; &#39;0644&#39;,
        ;
        [ &#39;/etc/pam.d/atd&#39;, &#39;/etc/pam.d/crond&#39; ]:
        ;
        &#39;/etc/pam.d/sudo&#39;:
            content =&gt; epp(&#39;pam/etc/pam.d/sudo&#39;, {
              &#39;pam_module_path&#39; =&gt; &#39;system-auth&#39;,
              &#39;force_revoke&#39;    =&gt; false,
              &#39;tty_audit_users&#39; =&gt; $tty_audit_users,
            })
        ;
        &#39;/etc/pam.d/sudo-i&#39;:
            content =&gt; epp(&#39;pam/etc/pam.d/sudo&#39;, {
              &#39;pam_module_path&#39; =&gt; &#39;sudo&#39;,
              &#39;force_revoke&#39;    =&gt; true,
              &#39;tty_audit_users&#39; =&gt; $tty_audit_users,
            })
        ;
        &#39;/etc/pam.d/other&#39;:
          content =&gt; $_other_content,
        ;
      }


      if ($disable_authconfig == true) {
        # Get rid of authconfig so that the tool can&#39;t be used to modify PAM.
        case $facts[&#39;os&#39;][&#39;name&#39;] {
          &#39;RedHat&#39;,&#39;CentOS&#39;: {
            file { [
              &#39;/usr/sbin/authconfig&#39;,
              &#39;/usr/sbin/authconfig-tui&#39;
              ]:
                ensure =&gt; &#39;absent&#39;
            }
          }
          default: {
            warning(&#39;Only RedHat and CentOS are currently supported by the pam module.&#39;)
          }
        }
      }

      if ! empty($auth_sections) { ::pam::auth { $auth_sections: } }
    }
  }
  else {
  # The global catalyst was set to false but the module was included
    if $enable_warning {
      if simplib::lookup(&#39;simp_options::pam&#39;, { &#39;default_value&#39; =&gt; true }) == false {
        warning(&#39;Module pupmod-simp-pam was included but global catalyst simp_options::pam is set to false. This could have unexpected effects.&#39;)
      }
    }
  }
}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>