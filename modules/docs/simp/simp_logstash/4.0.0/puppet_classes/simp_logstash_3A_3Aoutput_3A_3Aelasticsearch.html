<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Class: simp_logstash::output::elasticsearch
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_classes::simp_logstash::output::elasticsearch";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_class_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (s)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Classes</span></span>
     &raquo; 
    <span class="title">simp_logstash::output::elasticsearch</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Class: simp_logstash::output::elasticsearch</h1>
<div class="box_info">
  
  
  <dl>
    <dt>Defined in:</dt>
    <dd>
      /tmp/tmp_git_repo20171214-12245-u6n33h/manifests/output/elasticsearch.pp
    </dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="docstring">
  <div class="discussion">
    <p>A Logstash output to Elasticsearch</p>

<p>Though this class has a great deal repeated with the other output classes,
they remain separate in the event that variables need to be added in the
future for ERB processing.</p>

  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>action</span>
      
      
        <span class='type'>(<tt>Optional[Array[Enum['index','delete','create']]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The Elasticsearch action to perform.
Allowed Values: index, delete, create, update
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>codec</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The codec used for output data.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>doc_as_upsert</span>
      
      
        <span class='type'>(<tt>Optional[Boolean]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Create a new document with source if
<code>document_id</code> doesn’t exist in Elasticsearch.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>document_id</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The document ID for the index.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>document_type</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The document type to write events to.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>host</span>
      
      
        <span class='type'>(<tt>Simplib::Host</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>&#39;localhost&#39;</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The host of the remote instance.
@note It is highly recommended that you couple an Elasticsearch ingest node
with the LogStash server itself.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>port</span>
      
      
        <span class='type'>(<tt>Simplib::Port</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>9199</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The port on the remote instance to which to connect.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>idle_flush_time</span>
      
      
        <span class='type'>(<tt>Optional[Integer[0]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The amount of time since last flush before a
flush is forced.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>index</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The index to write events to.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>manage_template</span>
      
      
        <span class='type'>(<tt>Optional[Boolean]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If set, apply a default mapping template
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>parent</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The ID of the associated parent document.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>path</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>HTTP path at which the Elasticsearch server lives.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>retry_max_interval</span>
      
      
        <span class='type'>(<tt>Optional[Integer[0]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Set max interval between bulk retries.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>routing</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>A routing override to be applieid to all events.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>script</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Set script name for scripted update module.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>script_lang</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Set the language of the used script.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>script_type</span>
      
      
        <span class='type'>(<tt>Optional[Array[Enum['inline','idexed','file']]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Define the type of script referenced by <code>$script</code>.
Allowed Values: ‘inline’, ‘indexed’, ‘file’
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>script_var_name</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Variable name passed to script.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>scripted_upsert</span>
      
      
        <span class='type'>(<tt>Optional[Boolean]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If set, <code>$script</code> is in charge of creating
non-existent document
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>template</span>
      
      
        <span class='type'>(<tt>Optional[Stdlib::Absolutepath]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The path to your own template.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>template_name</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The name of the template in Elasticsearch.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>template_overwrite</span>
      
      
        <span class='type'>(<tt>Optional[Boolean]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If set, overwrite the indicated template
in ES with either the one dicated by <code>template</code> or the included one.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>timeout</span>
      
      
        <span class='type'>(<tt>Optional[Integer[0]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Timeout for network operations.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>upsert</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Upsert content for update mode.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>workers</span>
      
      
        <span class='type'>(<tt>Optional[Integer[0]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Number of workers to use for this output.
@see https://www.elastic.co/guide/en/logstash/current/plugins-outputs-elasticsearch.html</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>order</span>
      
      
        <span class='type'>(<tt>Integer[0]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>50</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The relative order within the configuration group. If
omitted, the entries will fall in alphabetical order.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>content</span>
      
      
        <span class='type'>(<tt>Optional[String]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The content that you wish to have in your filter. If
set, this will override <em>all</em> template contents.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stunnel_port</span>
      
      
        <span class='type'>(<tt>Simplib::Port</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>9200</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>The port on the local host to which to connect to
use the stunnel connection to the remote ES system. This is not required if
you are connecting to an ES server on the local system.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stunnel_verify</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>2</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Level of mutual authentication to perform</p>

<ul>
  <li>RHEL 6 Options:
    <ul>
      <li>level 1 - verify peer certificate if present</li>
      <li>level 2 - verify peer certificate</li>
      <li>level 3 - verify peer with locally installed certificate</li>
      <li>default - no verify</li>
    </ul>
  </li>
  <li>RHEL 7 Options:
    <ul>
      <li>level 0 - Request and ignore peer certificate.</li>
      <li>level 1 - Verify peer certificate if present.</li>
      <li>level 2 - Verify peer certificate.</li>
      <li>level 3 - Verify peer with locally installed certificate.</li>
      <li>level 4 - Ignore CA chain and only verify peer certificate.</li>
      <li>default - No verify</li>
    </ul>
  </li>
</ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>stunnel_elasticsearch</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>true</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>If set, use a stunnel connection to
connect to ES. This is necessary if you are using ES behind an HTTPS proxy.
If you’re using ES on the same host, and using the <code>::simp_elasticsearch</code>
class (the default), then the system will auto-adjust to ignore this
setting.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>flush_size</span>
      
      
        <span class='type'>(<tt>Optional[Integer[0]]</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>undef</tt>)</em>
      
      
    </li>
  
</ul>

<p class="tag_title">Author:</p>
<ul class="author">
  
    <li>
      
      
      
      
        
        <div class='inline'><p>Trevor Vaughan <a href="mailto:tvaughan@onyxpoint.com">tvaughan@onyxpoint.com</a></p>
</div>
      
    </li>
  
</ul>

</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File '/tmp/tmp_git_repo20171214-12245-u6n33h/manifests/output/elasticsearch.pp', line 128</span>

class simp_logstash::output::elasticsearch (
  Optional[Array[Enum[&#39;index&#39;,&#39;delete&#39;,&#39;create&#39;]]]  $action                = undef,
  Optional[String]                                  $codec                 = undef,
  Optional[Boolean]                                 $doc_as_upsert         = undef,
  Optional[String]                                  $document_id           = undef,
  Optional[String]                                  $document_type         = undef,
  Optional[Integer[0]]                              $flush_size            = undef,
  Simplib::Host                                     $host                  = &#39;localhost&#39;,
  Simplib::Port                                     $port                  = 9199,
  Optional[Integer[0]]                              $idle_flush_time       = undef,
  Optional[String]                                  $index                 = undef,
  Optional[Boolean]                                 $manage_template       = undef,
  Optional[String]                                  $parent                = undef,
  Optional[Stdlib::Absolutepath]                    $path                  = undef,
  Optional[Integer[0]]                              $retry_max_interval    = undef,
  Optional[String]                                  $routing               = undef,
  Optional[String]                                  $script                = undef,
  Optional[String]                                  $script_lang           = undef,
  Optional[Array[Enum[&#39;inline&#39;,&#39;idexed&#39;,&#39;file&#39;]]]   $script_type           = undef,
  Optional[String]                                  $script_var_name       = undef,
  Optional[Boolean]                                 $scripted_upsert       = undef,
  Optional[Stdlib::Absolutepath]                    $template              = undef,
  Optional[String]                                  $template_name         = undef,
  Optional[Boolean]                                 $template_overwrite    = undef,
  Optional[Integer[0]]                              $timeout               = undef,
  Optional[String]                                  $upsert                = undef,
  Optional[Integer[0]]                              $workers               = undef,
  Integer[0]                                        $order                 = 50,
  Optional[String]                                  $content               = undef,
  Integer                                           $stunnel_verify        = 2,
  Simplib::Port                                     $stunnel_port          = 9200,
  Boolean                                           $stunnel_elasticsearch = true
) {

  $_is_local = host_is_me($host)

  if $stunnel_elasticsearch {
    include &#39;::stunnel&#39;

    $_host = &#39;127.0.0.1&#39;

    if $_is_local {
      $_port = $port
    }
    else {
      stunnel::connection { &#39;logstash_elasticsearch&#39;:
        client  =&gt; true,
        connect =&gt; [&quot;${host}:${stunnel_port}&quot;],
        accept  =&gt; &quot;${_host}:${stunnel_port}&quot;,
        verify  =&gt; $stunnel_verify
      }

      $_port = $stunnel_port
    }
  }
  else {
    $_host = $host
    $_port = $port
  }

  ### Common material to all outputs
  include &#39;::simp_logstash&#39;

  $_component_name = &#39;elasticsearch&#39;
  $_group = &#39;output&#39;
  $_group_order = $::simp_logstash::config_order[$_group]

  if empty($content) {
    $_content = template(&quot;${module_name}/${_group}/${_component_name}.erb&quot;)
  }
  else {
    $_content = $content
  }

  file { &quot;${::simp_logstash::config_prefix}-${_group_order}_${_group}-${order}-${_component_name}${::simp_logstash::config_suffix}&quot;:
    ensure  =&gt; &#39;file&#39;,
    owner   =&gt; &#39;root&#39;,
    group   =&gt; $::logstash::logstash_group,
    mode    =&gt; &#39;0640&#39;,
    content =&gt; $_content,
    notify  =&gt; Class[&#39;logstash::service&#39;]
  }
  ### End common material
}</pre>
      </td>
    </tr>
  </table>
</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>