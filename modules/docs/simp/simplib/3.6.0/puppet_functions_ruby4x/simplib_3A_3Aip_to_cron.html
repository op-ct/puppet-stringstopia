<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>
  Puppet Function: simplib::ip_to_cron (Ruby 4.x API)
  
    &mdash; Documentation by YARD 0.9.12
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  pathId = "puppet_functions_ruby4x::simplib::ip_to_cron";
  relpath = '../';
</script>


  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <div class="nav_wrap">
      <iframe id="nav" src="../puppet_function_list.html?1"></iframe>
      <div id="resizer"></div>
    </div>

    <div id="main" tabindex="-1">
      <div id="header">
        <div id="menu">
  
    <a href="../_index.html">Index (s)</a> &raquo;
    <span class='title'><span class='object_link'>Puppet Functions</span></span>
     &raquo; 
    <span class="title">simplib::ip_to_cron</span>
  
</div>

        <div id="search">
  
    <a class="full_list_link" id="puppet_class_list_link"
        href="../puppet_class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
        <div class="clear"></div>
      </div>

      <div id="content"><h1>Puppet Function: simplib::ip_to_cron</h1>
<div class="box_info">
  <dl>
    <dt>Defined in:</dt>
    <dd>
      lib/puppet/functions/simplib/ip_to_cron.rb<span class="defines">,<br />
      /tmp/tmp_git_repo20171214-12245-rji9kl/lib/puppet/functions/simplib/ip_to_cron.rb</div>
      
    </dd>
  </dl>
  <dl>
    <dt>Function type:</dt>
    <dd>Ruby 4.x API</dd>
  </dl>
</div>

<h2>Overview</h2>
<div class="method_details first">
  
  <div class="tags overload overload_item">
    <span class="overload">
      <span class="overload_item">
        <span class="signature first" style="margin-left: 0px;"><strong>simplib::ip_to_cron(Optional[Integer[1]] $occurs, Optional[Integer[1]] $max_value, Optional[IpToCronAlgorithm] $algorithm, Optional[Simplib::IP] $ip)</strong> &#x21d2; <tt>Array[Integer]</tt> </span>
      </span>
    </span>
  </div>
  
  <div class="docstring">
    <div class="discussion">
      <p>Transforms an IP address to one or more interval values for <code>cron</code>.
 This can be used to avoid starting a certain cron job at the same
 time on all servers.</p>

    </div>
  </div>
  <div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Generate one value for the <code>minute</code> cron interval</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_ip_to_cron'>ip_to_cron</span><span class='lparen'>(</span><span class='rparen'>)</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Generate 2 values for the <code>hour</code> cron interval, using the</p>
</div></p>
      
      <pre class="example code"><code>&#39;sha256&#39; algorithm and a provided IP address

ip_to_cron(2,23,&#39;sha256&#39;,&#39;10.0.23.45&#39;)</code></pre>
    
  </div>

<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>occurs</span>
      
      
        <span class='type'>(<tt>Optional[Integer[1]]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The occurrence within an interval, i.e., the number of values to
be generated for the interval.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max_value</span>
      
      
        <span class='type'>(<tt>Optional[Integer[1]]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The maximum value for the interval.  The values generated will
be in the inclusive range [0, max_value].</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>algorithm</span>
      
      
        <span class='type'>(<tt>Optional[IpToCronAlgorithm]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>When ‘ip_mod’, the modulus of the IP number is used as the basis
for the returned values.  This algorithm works well to create
cron job intervals for multiple hosts, when the number of hosts
exceeds the <code>max_value</code> and the hosts have largely, linearly-
assigned IP addresses.</p>

<p>When ‘sha256’, a random number generated using the IP address
string is the basis for the returned values.  This algorithm
works well to create cron job intervals for multiple hosts,
when the number of hosts is less than the <code>max_value</code> or the
hosts do not have linearly-assigned IP addresses.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>ip</span>
      
      
        <span class='type'>(<tt>Optional[Simplib::IP]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The IP address to use as the basis for the generated values.
When <code>nil</code>, the ‘ipaddress’ fact (IPv4) is used.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array[Integer]</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Array of integers suitable for use in the
<code>minute</code> or <code>hour</code> cron field.</p>
</div>
      
    </li>
  
</ul>

</div><div class="method_details_list">
  <table class="source_code">
    <tr>
      <td>
        <pre class="lines">


4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre>
      </td>
      <td>
        <pre class="code"><span class="info file"># File 'lib/puppet/functions/simplib/ip_to_cron.rb', line 4</span>

<span class='const'>Puppet</span><span class='op'>::</span><span class='const'>Functions</span><span class='period'>.</span><span class='id identifier rubyid_create_function'>create_function</span><span class='lparen'>(</span><span class='symbol'>:simplib::ip_to_cron</span><span class='tstring_end'>&#39;</span></span><span class='rparen'>)</span> <span class='kw'>do</span>

  <span class='id identifier rubyid_local_types'>local_types</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_type'>type</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>IpToCronAlgorithm = Enum[&#39;ip_mod&#39;, &#39;sha256&#39;]</span><span class='tstring_end'>&quot;</span></span>
  <span class='kw'>end</span>

  <span class='comment'># @param occurs
</span>  <span class='comment'>#   The occurrence within an interval, i.e., the number of values to
</span>  <span class='comment'>#   be generated for the interval.
</span>  <span class='comment'>#
</span>  <span class='comment'># @param max_value
</span>  <span class='comment'>#   The maximum value for the interval.  The values generated will
</span>  <span class='comment'>#   be in the inclusive range [0, max_value].
</span>  <span class='comment'>#
</span>  <span class='comment'># @param algorithm
</span>  <span class='comment'>#   When &#39;ip_mod&#39;, the modulus of the IP number is used as the basis
</span>  <span class='comment'>#   for the returned values.  This algorithm works well to create
</span>  <span class='comment'>#   cron job intervals for multiple hosts, when the number of hosts
</span>  <span class='comment'>#   exceeds the `max_value` and the hosts have largely, linearly-
</span>  <span class='comment'>#   assigned IP addresses.
</span>  <span class='comment'>#
</span>  <span class='comment'>#   When &#39;sha256&#39;, a random number generated using the IP address
</span>  <span class='comment'>#   string is the basis for the returned values.  This algorithm
</span>  <span class='comment'>#   works well to create cron job intervals for multiple hosts,
</span>  <span class='comment'>#   when the number of hosts is less than the `max_value` or the
</span>  <span class='comment'>#   hosts do not have linearly-assigned IP addresses.
</span>  <span class='comment'>#
</span>  <span class='comment'># @param ip
</span>  <span class='comment'>#   The IP address to use as the basis for the generated values.
</span>  <span class='comment'>#   When `nil`, the &#39;ipaddress&#39; fact (IPv4) is used.
</span>  <span class='comment'>#
</span>  <span class='comment'># @return [Array[Integer]] Array of integers suitable for use in the
</span>  <span class='comment'>#   ``minute`` or ``hour`` cron field.
</span>  <span class='comment'>#
</span>  <span class='comment'># @example Generate one value for the `minute` cron interval
</span>  <span class='comment'>#   ip_to_cron()
</span>  <span class='comment'>#
</span>  <span class='comment'># @example Generate 2 values for the `hour` cron interval, using the
</span>  <span class='comment'>#   &#39;sha256&#39; algorithm and a provided IP address
</span>  <span class='comment'>#
</span>  <span class='comment'>#   ip_to_cron(2,23,&#39;sha256&#39;,&#39;10.0.23.45&#39;)
</span>  <span class='comment'>#
</span>
  <span class='id identifier rubyid_dispatch'>dispatch</span> <span class='symbol'>:ip_to_cron</span> <span class='kw'>do</span>
    <span class='id identifier rubyid_optional_param'>optional_param</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Integer[1]</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='symbol'>:occurs</span>
    <span class='id identifier rubyid_optional_param'>optional_param</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Integer[1]</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>        <span class='symbol'>:max_value</span>
    <span class='id identifier rubyid_optional_param'>optional_param</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>IpToCronAlgorithm</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='symbol'>:algorithm</span>
    <span class='id identifier rubyid_optional_param'>optional_param</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>Simplib::IP</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span>       <span class='symbol'>:ip</span>
  <span class='kw'>end</span>

  <span class='kw'>def</span> <span class='id identifier rubyid_ip_to_cron'>ip_to_cron</span><span class='lparen'>(</span><span class='id identifier rubyid_occurs'>occurs</span> <span class='op'>=</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id identifier rubyid_max_value'>max_value</span> <span class='op'>=</span> <span class='int'>59</span><span class='comma'>,</span> <span class='id identifier rubyid_algorithm'>algorithm</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ip_mod</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ip'>ip</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
      <span class='id identifier rubyid_scope'>scope</span> <span class='op'>=</span> <span class='id identifier rubyid_closure_scope'>closure_scope</span>
      <span class='id identifier rubyid_ipaddr'>ipaddr</span> <span class='op'>=</span> <span class='id identifier rubyid_scope'>scope</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>facts</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>ipaddress</span><span class='tstring_end'>&#39;</span></span><span class='rbracket'>]</span>
    <span class='kw'>else</span>
      <span class='id identifier rubyid_ipaddr'>ipaddr</span> <span class='op'>=</span> <span class='id identifier rubyid_ip'>ip</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_call_function'>call_function</span><span class='lparen'>(</span><span class='tstring'><span class='tstring_beg'>&#39;</span><span class='tstring_content'>simplib::rand_cron</span><span class='tstring_end'>&#39;</span></span><span class='comma'>,</span> <span class='id identifier rubyid_ipaddr'>ipaddr</span><span class='comma'>,</span> <span class='id identifier rubyid_algorithm'>algorithm</span><span class='comma'>,</span> <span class='id identifier rubyid_occurs'>occurs</span><span class='comma'>,</span> <span class='id identifier rubyid_max_value'>max_value</span><span class='rparen'>)</span>
  <span class='kw'>end</span>
<span class='kw'>end</span></pre>
      </td>
    </tr>
  </table>
</div>

</div>
</div>

      <div id="footer">
     Generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>.
</div>

    </div>
  </body>
</html>